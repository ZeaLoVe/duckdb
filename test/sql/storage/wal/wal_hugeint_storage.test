# name: test/sql/storage/wal/wal_BIGINT_storage.test
# description: Test BIGINT with persistent storage with WAL
# group: [wal]

# load the DB from disk
load __TEST_DIR__/BIGINT_storage_test.db





# create a table with BIGINTs
statement ok
CREATE TABLE BIGINTs (h BIGINT);

statement ok
INSERT INTO BIGINTs VALUES (1043178439874412422424), (42), (NULL), (47289478944894789472897441242);

# reload the database from disk a few times, and check that the data is still there
loop i 0 2

restart



query I
SELECT * FROM BIGINTs
----
1043178439874412422424
42
NULL
47289478944894789472897441242

query I
SELECT * FROM BIGINTs WHERE h = 42
----
42

query I
SELECT h FROM BIGINTs WHERE h < 10 ORDER BY 1;
----

endloop
