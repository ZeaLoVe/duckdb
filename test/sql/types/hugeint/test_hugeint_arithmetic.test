# name: test/sql/types/BIGINT/test_BIGINT_arithmetic.test
# description: Test arithmetic with huge integers
# group: [BIGINT]



# negation
query II
SELECT -(100::BIGINT), -(-(50::BIGINT));
----
-100	50

# negate 0
query I
SELECT -(0::BIGINT)
----
0

# negation with large numbers
query II
SELECT -(100000000000000000000::BIGINT), -(-(100000000000000000000::BIGINT));
----
-100000000000000000000	100000000000000000000

# addition
# simple addition: small values
query I
SELECT 42::BIGINT + 42::BIGINT;
----
84

# negative values
query III
SELECT 42::BIGINT + -42::BIGINT, -42::BIGINT + 100::BIGINT, -42::BIGINT+-42::BIGINT;
----
0	58	-84

# large values
query I
SELECT '100000000000000000000'::BIGINT + '100000000000000000000'::BIGINT;
----
200000000000000000000

# large negative values
query I
SELECT '100000000000000000000'::BIGINT + '-1000000000000000000000'::BIGINT;
----
-900000000000000000000

query I
SELECT '5'::BIGINT + '-10000000000000000002'::BIGINT;
----
-9999999999999999997

# overflow in addition
statement error
SELECT '170141183460469231731687303715884105727'::BIGINT + '170141183460469231731687303715884105727'::BIGINT;

statement error
SELECT '170141183460469231731687303715884105727'::BIGINT + '10'::BIGINT;

# almost overflowing but not quite
query I
SELECT '170141183460469231731687303715884105727'::BIGINT - 10::BIGINT + 10::BIGINT
----
170141183460469231731687303715884105727

query I
SELECT '-170141183460469231731687303715884105727'::BIGINT + 10::BIGINT - 10::BIGINT
----
-170141183460469231731687303715884105727

# overflowing
statement error
SELECT '170141183460469231731687303715884105727'::BIGINT - 10::BIGINT + 11::BIGINT

statement error
SELECT '-170141183460469231731687303715884105727'::BIGINT + 10::BIGINT - 11::BIGINT

# subtraction
query II
SELECT 100::BIGINT - 42::BIGINT, 3::BIGINT - 5::BIGINT;
----
58	-2

# negative combinations
query III
SELECT -100::BIGINT - 42::BIGINT, -3::BIGINT - 5::BIGINT, 12::BIGINT-(-12::BIGINT);
----
-142	-8	24

# large subtraction
query I
SELECT '-10000000000000000002'::BIGINT - '-10000000000000000002'::BIGINT;
----
0

# underflow in subtraction
statement error
SELECT '-170141183460469231731687303715884105727'::BIGINT - '170141183460469231731687303715884105727'::BIGINT;

statement error
SELECT '170141183460469231731687303715884105727'::BIGINT - '-170141183460469231731687303715884105727'::BIGINT;

# multiplication
query I
SELECT 100::BIGINT * 50::BIGINT;
----
5000

# negative multiplication
query III
SELECT 100::BIGINT * -50::BIGINT, -100::BIGINT * 50::BIGINT, -100::BIGINT * -50::BIGINT;
----
-5000	-5000	5000

# multiplying large numbers
query II
SELECT '1701411834604692317'::BIGINT * '2'::BIGINT, '100000000000000000000'::BIGINT * '1000000000000000000'::BIGINT
----
3402823669209384634	100000000000000000000000000000000000000

query I
SELECT '170141183460469231731687303715884105727'::BIGINT * 1::BIGINT
----
170141183460469231731687303715884105727

# overflow in multiplication
statement error
SELECT '170141183460469231731687303715884105727'::BIGINT * 2::BIGINT

statement error
SELECT '1701411834604692317'::BIGINT * '131687303715884105727'::BIGINT

# division
query II
SELECT 100::BIGINT / 20::BIGINT, 90::BIGINT / 20::BIGINT
----
5	4

# negative values
query III
SELECT -100::BIGINT / 20::BIGINT, 100::BIGINT / -20::BIGINT, -100::BIGINT / -20::BIGINT
----
-5	-5	5

# division by zero
query I
SELECT 100::BIGINT / 0::BIGINT
----
NULL

# large values
query II
SELECT '100000000000000000000000000000000000000'::BIGINT / '10000000000000'::BIGINT, '100000000000000000000000000000000000000'::BIGINT / '2'::BIGINT
----
10000000000000000000000000	50000000000000000000000000000000000000

# modulo
query II
SELECT 100::BIGINT % 20::BIGINT, 90::BIGINT % 20::BIGINT
----
0	10

# negative values
query III
SELECT -90 % 20, 90 % -20, -90 % -20
----
-10	10	-10

query III
SELECT -90::BIGINT % 20::BIGINT, 90::BIGINT % -20::BIGINT, -90::BIGINT % -20::BIGINT
----
-10	10	-10

# modulo by zero
query I
SELECT 100::BIGINT % 0::BIGINT
----
NULL

# large values
query II
SELECT '100000000000000000000000000000000000000'::BIGINT % '6587689457689375689735'::BIGINT, '100000000000000000000000000000000000000'::BIGINT % '3'::BIGINT
----
5396771390320972230850	1

# abs
query II
SELECT ABS('100'::BIGINT), ABS('-100'::BIGINT);;
----
100	100

# addition
query I
SELECT '-170141183460469231731687303715884105726'::BIGINT + -1;
----
-170141183460469231731687303715884105727

query I
SELECT '170141183460469231731687303715884105726'::BIGINT + 1;
----
170141183460469231731687303715884105727

statement error
SELECT -170141183460469231731687303715884105727 + -1;

statement error
SELECT 170141183460469231731687303715884105727 + 1;

# the other way around (i.e. move away from the overflow direction)
query I
SELECT '170141183460469231731687303715884105727'::BIGINT + -1;
----
170141183460469231731687303715884105726

query I
SELECT '-170141183460469231731687303715884105727'::BIGINT + 1;
----
-170141183460469231731687303715884105726

# now the reverse: right side is big
query I
SELECT -1 + '-170141183460469231731687303715884105726'::BIGINT;
----
-170141183460469231731687303715884105727

query I
SELECT 1 + '170141183460469231731687303715884105726'::BIGINT;
----
170141183460469231731687303715884105727

statement error
SELECT -1 + -170141183460469231731687303715884105727;

statement error
SELECT 1 + 170141183460469231731687303715884105727;

# the other way around (i.e. move away from the overflow direction)
query I
SELECT -1 + '170141183460469231731687303715884105727'::BIGINT;
----
170141183460469231731687303715884105726

query I
SELECT 1 + '-170141183460469231731687303715884105727'::BIGINT;
----
-170141183460469231731687303715884105726

# subtraction
query I
SELECT '-170141183460469231731687303715884105726'::BIGINT - 1;
----
-170141183460469231731687303715884105727

statement error
SELECT -170141183460469231731687303715884105727 - 1;

query I
SELECT 170141183460469231731687303715884105724 - (-1);
----
170141183460469231731687303715884105725

query I
SELECT 170141183460469231731687303715884105725 - (-1);
----
170141183460469231731687303715884105726

query I
SELECT 170141183460469231731687303715884105726 - (-1);
----
170141183460469231731687303715884105727

statement error
SELECT 170141183460469231731687303715884105727 - (-1);

# the other way around (i.e. move away from the overflow direction)
query I
SELECT 170141183460469231731687303715884105727 - 1;
----
170141183460469231731687303715884105726

query I
SELECT -170141183460469231731687303715884105727 - (-1);
----
-170141183460469231731687303715884105726

# now the reverse: right side is big
query I
SELECT -1 - 170141183460469231731687303715884105726;
----
-170141183460469231731687303715884105727

statement error
SELECT -1 - 170141183460469231731687303715884105727;

query I
SELECT 1 - (-170141183460469231731687303715884105724);
----
170141183460469231731687303715884105725

query I
SELECT 1 - (-170141183460469231731687303715884105725);
----
170141183460469231731687303715884105726

query I
SELECT 1 - (-170141183460469231731687303715884105726);
----
170141183460469231731687303715884105727

statement error
SELECT 1 - (-170141183460469231731687303715884105727);

# the other way around (i.e. move away from the overflow direction)
query I
SELECT -1 - (-170141183460469231731687303715884105727);
----
170141183460469231731687303715884105726

query I
SELECT 1 - 170141183460469231731687303715884105727;
----
-170141183460469231731687303715884105726

# multiplication
query I
SELECT 170141183460469231731687303715884105727 * 1;
----
170141183460469231731687303715884105727

query I
SELECT 170141183460469231731687303715884105727 * -1;
----
-170141183460469231731687303715884105727

query I
SELECT -170141183460469231731687303715884105727 * 1;
----
-170141183460469231731687303715884105727

query I
SELECT -170141183460469231731687303715884105727 * -1;
----
170141183460469231731687303715884105727

statement error
SELECT 85070591730234615865843651857942052864 * 2

statement error
SELECT -85070591730234615865843651857942052864 * 2

statement error
SELECT 85070591730234615865843651857942052864 * -2

statement error
SELECT -85070591730234615865843651857942052864 * -2

# division
query I
SELECT 170141183460469231731687303715884105727 / 1;
----
170141183460469231731687303715884105727

query I
SELECT 170141183460469231731687303715884105727 / -1;
----
-170141183460469231731687303715884105727

query I
SELECT -170141183460469231731687303715884105727 / 1;
----
-170141183460469231731687303715884105727

query I
SELECT -170141183460469231731687303715884105727 / -1;
----
170141183460469231731687303715884105727

# comparisons
query II
SELECT '5'::BIGINT <> '5'::BIGINT, '5'::BIGINT <> '18446744073709551621'::BIGINT
----
false	true
