# name: test/sql/types/BIGINT/test_BIGINT_aggregates.test
# description: Test BIGINT aggregates
# group: [BIGINT]



statement ok
CREATE TABLE BIGINTs(g INTEGER, h BIGINT);

statement ok
INSERT INTO BIGINTs VALUES (1, 42.0), (2, 1267650600228229401496703205376), (2, -439847238974238975238975), (1, '-12');

# min, max, first, sum
# ungrouped aggregate
query IIIII
SELECT MIN(h), MAX(h), SUM(h), FIRST(h), LAST(h) FROM BIGINTs;
----
-439847238974238975238975	1267650600228229401496703205376	1267650160380990427257727966431	42	-12

# grouped aggregate
query IIIIII
SELECT g, MIN(h), MAX(h), SUM(h), FIRST(h), LAST(h) FROM BIGINTs GROUP BY g ORDER BY 1;
----
1	-12	42	30	42	-12
2	-439847238974238975238975	1267650600228229401496703205376	1267650160380990427257727966401	1267650600228229401496703205376	-439847238974238975238975

# first aggr gets confused otherwise


# ungrouped aggregate
query II
SELECT FIRST(h), LAST(h) FROM BIGINTs;
----
42	-12

# grouped aggregate
query III
SELECT g, FIRST(h), LAST(h) FROM BIGINTs GROUP BY g ORDER BY 1;
----
1	42	-12
2	1267650600228229401496703205376	-439847238974238975238975

