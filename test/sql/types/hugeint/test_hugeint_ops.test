# name: test/sql/types/BIGINT/test_BIGINT_ops.test
# description: Test various huge integer ops
# group: [BIGINT]



# test storage of the BIGINT type
statement ok
CREATE TABLE BIGINTs(h BIGINT);

statement ok
INSERT INTO BIGINTs VALUES (42::BIGINT), ('1267650600228229401496703205376'::BIGINT);

# out of range conversion
# statement error
# SELECT h::INTEGER FROM BIGINTs

# filter before cast works
query I
SELECT h::INTEGER FROM BIGINTs WHERE h < 100
----
42

# test different comparison ops
query I
SELECT COUNT(*) FROM BIGINTs WHERE h = 42::BIGINT
----
1

query I
SELECT COUNT(*) FROM BIGINTs WHERE h <> '1267650600228229401496703205376'::BIGINT
----
1

query I
SELECT COUNT(*) FROM BIGINTs WHERE h < '1267650600228229401496703205376'::BIGINT
----
1

query I
SELECT COUNT(*) FROM BIGINTs WHERE h <= '1267650600228229401496703205376'::BIGINT
----
2

query I
SELECT COUNT(*) FROM BIGINTs WHERE h > '1267650600228229401496703205375'::BIGINT
----
1

query I
SELECT COUNT(*) FROM BIGINTs WHERE h >= 42::BIGINT
----
2

# joins
statement ok
CREATE TABLE BIGINTs2(h BIGINT);
INSERT INTO BIGINTs2 VALUES (42::BIGINT);

query I
SELECT * FROM BIGINTs JOIN BIGINTs2 USING (h);
----
42

query II
SELECT * FROM BIGINTs t1 JOIN BIGINTs2 t2 ON t1.h <> t2.h
----
1267650600228229401496703205376	42

query II
SELECT * FROM BIGINTs t1 JOIN BIGINTs2 t2 ON t1.h >= t2.h ORDER BY 1 LIMIT 2
----
42	42
1267650600228229401496703205376	42
