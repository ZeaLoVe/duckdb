# name: test/sql/types/BIGINT/test_BIGINT_bitwise.test
# description: Test bitwise operations of huge int type
# group: [BIGINT]



# left-shift
query I
SELECT 1::BIGINT << 3
----
8

query I
SELECT 27::BIGINT << 0
----
27

statement error
SELECT -27::BIGINT << 1

# large shifts
query II
select 1::BIGINT << 50, 1::BIGINT << 100;
----
1125899906842624	1267650600228229401496703205376

# shift chains
query II
select (((((1::BIGINT << 50) << 50) << 2) << 3) << 8), (1::BIGINT)<<50<<20<<7<<18<<3<<6<<9
----
10384593717069655257060992658440192	10384593717069655257060992658440192

query I
select 1::BIGINT << 64;
----
18446744073709551616


# out of bounds shifts
statement error
select 1::BIGINT << 200

statement error
SELECT '1329227995784915872903807060280344576'::BIGINT << 50;

statement error
SELECT 27::BIGINT << -1

statement error
SELECT 100::BIGINT << '1329227995784915872903807060280344576'::BIGINT

# right-shift
query I
SELECT 8::BIGINT >> 3
----
1

query I
SELECT 27::BIGINT >> 0
----
27

query I
SELECT -27::BIGINT >> 1
----
-14

query I
SELECT 27::BIGINT >> -1
----
0

# large shifts
query II
select (1::BIGINT << 100) >> 50, (1::BIGINT << 120)>>108;
----
1125899906842624	4096

query I
SELECT '1329227995784915872903807060280344576'::BIGINT >> 200
----
0

query I
select -11367237885269962203896920952509169001 >> 200;
----
0

query I
SELECT '1329227995784915872903807060280344576'::BIGINT >> 64
----
72057594037927936

query I
select -11367237885269962203896920952509169001 >> 64;
----
-616219200518461212

query I
SELECT '1329227995784915872903807060280344576'::BIGINT >> 96
----
16777216

query I
select -11367237885269962203896920952509169001 >> 96;
----
-143474714

query I
SELECT '1329227995784915872903807060280344576'::BIGINT >> 4 >> 5 >> 7 >> 9 >> 12 >> 13
----
1180591620717411303424

query I
SELECT -11367237885269962203896920952509169001 >> 4 >> 5 >> 7 >> 9 >> 12 >> 13
----
-10096135381294468483924

# bitwise &
query I
select 1::BIGINT & 3::BIGINT
----
1

query I
select 51290852742897895128414::BIGINT & 4923847238975289723895239078235::BIGINT
----
40291148384447586808154

# bitwise |
query I
select 1::BIGINT | 2::BIGINT
----
3

query I
select 51290852742897895128414::BIGINT | 4923847238975289723895239078235::BIGINT
----
4923847249974994082345547398495

# bitwise xor
query I
select xor(1::BIGINT, 3::BIGINT)
----
2

query I
select xor(51290852742897895128414::BIGINT, 4923847238975289723895239078235::BIGINT)
----
4923847209683845697897960590341

# bitwise not
query I
select ~(1::BIGINT)
----
-2

query I
select ~(4923847238975289723895239078235::BIGINT)
----
-4923847238975289723895239078236

# big shifts
query I
select 1::BIGINT >> 1000;
----
0

query I
select 1 >> 170141183460469231731687303715884105727::BIGINT;
----
0

statement error
select 1::BIGINT << 1000;

statement error
select 1 << 170141183460469231731687303715884105727::BIGINT;
