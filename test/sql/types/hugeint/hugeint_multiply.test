# name: test/sql/types/BIGINT/BIGINT_multiply.test
# description: Test correct computation of BIGINT multiplication
# group: [BIGINT]

# overflows of various parts of the multiplication
# BIGINT multiplication is done in 4 segments (low bits & high bits of the lower and upper int64 part)
# we test all combinations here
# 251658240           =                  [low, low]
# 1080863910568919040 =                  [low, high]
# 4642275147320176030871715840           [high, low]
# 19938419936773738093557105904205168640 [high, high]

# [low, low] mult
query I
SELECT 251658240::BIGINT * 251658240::BIGINT
----
63331869759897600

query I
SELECT 251658240::BIGINT * 1080863910568919040::BIGINT
----
272008309413291564308889600

query I
SELECT 251658240::BIGINT * 4642275147320176030871715840::BIGINT
----
1168266793170336216419361674074521600

statement error
SELECT 251658240::BIGINT * 19938419936773738093557105904205168640::BIGINT

# [low, high]
query I
SELECT 1080863910568919040::BIGINT * 251658240::BIGINT
----
272008309413291564308889600

query I
SELECT 1080863910568919040::BIGINT * 1080863910568919040::BIGINT
----
1168266793170336216419361674074521600

statement error
SELECT 1080863910568919040::BIGINT * 4642275147320176030871715840::BIGINT

statement error
SELECT 1080863910568919040::BIGINT * 19938419936773738093557105904205168640::BIGINT

# [high, low]
query I
SELECT 4642275147320176030871715840::BIGINT * 251658240::BIGINT
----
1168266793170336216419361674074521600

statement error
SELECT 4642275147320176030871715840::BIGINT * 1080863910568919040::BIGINT

statement error
SELECT 4642275147320176030871715840::BIGINT * 4642275147320176030871715840::BIGINT

statement error
SELECT 4642275147320176030871715840::BIGINT * 19938419936773738093557105904205168640::BIGINT

# [high, high]
statement error
SELECT 19938419936773738093557105904205168640::BIGINT * 251658240::BIGINT

statement error
SELECT 19938419936773738093557105904205168640::BIGINT * 1080863910568919040::BIGINT

statement error
SELECT 19938419936773738093557105904205168640::BIGINT * 4642275147320176030871715840::BIGINT

statement error
SELECT 19938419936773738093557105904205168640::BIGINT * 19938419936773738093557105904205168640::BIGINT

# more overflow tests on the boundaries
query I
SELECT 85070591730234615865843651857942052863::BIGINT * 2::BIGINT
----
170141183460469231731687303715884105726

statement error
SELECT 85070591730234615865843651857942052864::BIGINT * 2::BIGINT

statement error
SELECT 85070591730234615865843651857942052865::BIGINT * 2::BIGINT

query I
SELECT 19807040628566084398385987583::BIGINT * 8589934592::BIGINT
----
170141183460469231731687303707294171136

statement error
SELECT 19807040628566084398385987584::BIGINT*8589934592::BIGINT;

query I
SELECT 36893488147419103231::BIGINT * 4611686018427387904::BIGINT
----
170141183460469231727075617697456717824

statement error
SELECT 36893488147419103232::BIGINT * 4611686018427387904::BIGINT

# now reverse sides
query I
SELECT 2::BIGINT * 85070591730234615865843651857942052863::BIGINT
----
170141183460469231731687303715884105726

statement error
SELECT 2::BIGINT * 85070591730234615865843651857942052864::BIGINT

statement error
SELECT 2::BIGINT * 85070591730234615865843651857942052865::BIGINT

query I
SELECT 8589934592::BIGINT * 19807040628566084398385987583::BIGINT
----
170141183460469231731687303707294171136

statement error
SELECT 8589934592::BIGINT * 19807040628566084398385987584::BIGINT

query I
SELECT 4611686018427387904::BIGINT * 36893488147419103231::BIGINT
----
170141183460469231727075617697456717824

statement error
SELECT 4611686018427387904::BIGINT * 36893488147419103232::BIGINT

query I
SELECT 10376293541461622783::BIGINT * 10376293541461622783::BIGINT
----
107667467658578185684455784799784665089

query I
SELECT 10376293541461622783::BIGINT * 10376293541461622783::BIGINT
----
107667467658578185684455784799784665089

statement error
SELECT 17293822569102704639::BIGINT * 10376293541461622783::BIGINT
